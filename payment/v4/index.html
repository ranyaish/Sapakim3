<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>אפליקציית חישוב משכורות — מינימום עובד</title>

  <style>
    :root{--ink:#0b1b2b;--line:#e9eef7;--acc:#7DB9FF}
    *{box-sizing:border-box}
    body{margin:0;font-family:Heebo,system-ui,Arial,sans-serif;color:var(--ink);background:#fff}
    header{position:sticky;top:0;background:#f7fbff;border-bottom:1px solid #e6eef8;padding:12px 14px;z-index:5}
    .wrap{max-width:1100px;margin:0 auto;padding:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:flex-end;margin-bottom:10px}
    .col{flex:1 1 260px;min-width:240px}
    label{font-size:14px;color:#345}
    input,select,button{font-size:14px}
    .inp{width:100%;padding:9px 10px;border:1px solid #d6dbe8;border-radius:10px;background:#fff}
    .btn{background:var(--acc);border:0;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .card{border:1px solid #e6eef8;border-radius:14px;padding:12px;background:#fff}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px 10px;border-bottom:1px solid var(--line);text-align:right}
    thead th{background:#f7fbff;font-weight:800}
    tfoot th, tfoot td{font-weight:800;background:#fbfdff}
    .tablewrap{overflow-x:auto}
    #summaryTable{min-width:1000px}
    .muted{font-size:12px;color:#60728d}
  </style>

  <!-- ספריות: SheetJS ו-XlsxPopulate -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx-populate/browser/xlsx-populate.min.js"></script>
</head>
<body>
  <header><b>אפליקציית חישוב משכורות — גרסת בסיס עובדת</b></header>

  <div class="wrap">
    <div class="card">
      <div class="row">
        <div class="col">
          <label>טעינת קובץ שעות (Excel/CSV)</label>
          <input id="file" type="file" accept=".xlsx,.xls,.csv" class="inp">
        </div>
        <div class="col">
          <label>בחירת עובד</label>
          <select id="employeeFilter" class="inp" disabled>
            <option value="ALL">כל העובדים</option>
          </select>
        </div>
        <div class="col" style="display:flex;gap:8px;flex-wrap:wrap">
          <button id="exportDaily" class="btn" disabled>ייצוא פירוט יומי (XLSX)</button>
          <button id="exportSummary" class="btn" disabled>ייצוא סיכום חודשי (XLSX)</button>
        </div>
        <div class="col" style="display:flex;gap:8px;flex-wrap:wrap">
          <button id="exportJSON" class="btn">ייצוא JSON</button>
          <button id="importJSON" class="btn" type="button">טעינת JSON</button>
          <input id="importJSONFile" type="file" accept=".json" style="display:none">
          <button id="clearSession" class="btn" type="button">ניקוי סשן</button>
        </div>
      </div>
      <div class="muted">טיפ: אם משהו לא נטען, פתח F12 → Console וחפש הודעות `[payroll]`.</div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="tablewrap">
        <table id="summaryTable">
          <thead>
            <tr>
              <th>עובד</th>
              <th>סה"כ שעות</th>
              <th>רגיל 100%</th>
              <th>נוספות 125%</th>
              <th>נוספות 150%</th>
              <th>שבת 150%</th>
              <th>שעות משוקללות</th>
              <th>שכר בסיס</th>
              <th>נסיעות</th>
              <th>טיפים</th>
              <th>תוספת שכר</th>
              <th>החזר מקדמה</th>
              <th>שכר ברוטו</th>
            </tr>
          </thead>
          <tbody></tbody>
          <tfoot>
            <tr id="summaryTotalsRow">
              <th>סה״כ</th>
              <td colspan="12"></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

  <script src="app.js?v=2.0.0"></script>
</body>
</html>
